# npx 信長

AI戦国シミュレーションゲーム。Google Gemini AIが大名や家臣として思考し、評定（会議）で議論を交わします。

## クイックスタート

```bash
npx ai-nobunaga
```

または、グローバルインストールして `信長` コマンドで実行:

```bash
npm install -g ai-nobunaga
信長
```

### APIキーの設定

初回起動時にAPIキーの入力を求められます。[Google AI Studio](https://aistudio.google.com/apikey) で取得してください。

入力したAPIキーは `~/.nobunaga` に保存され、次回以降は自動で読み込まれます。

```bash
# 環境変数で直接指定することも可能
GEMINI_API_KEY=your_api_key npx ai-nobunaga
```

## スクリーンショット

```text
╔══════════════════════════════════════════════╗
║ npx 信長 - ターン 1 - 織田家 (織田信長)        ║
╚══════════════════════════════════════════════╝
金: 5000 | 兵糧: 8000 | 兵: 3500 | 城: 2 | 行動: 3/3

┌─────────────────────────────────────────────┐
│ 1. 評定を開く                                │
│ 2. 領地を見る                                │
│ 3. 外交                                      │
│ 4. ターン終了                                │
└─────────────────────────────────────────────┘
```

## セットアップ

```bash
# 依存パッケージのインストール
npm install

# 環境変数の設定
cp .env.example .env
# .env を編集して GEMINI_API_KEY を設定

# 起動
npm run dev
```

## 遊び方

### 評定（会議）

「評定を開く」から議題を選択すると、家臣たちがAIで議論を行います。

- **状況報告**: 現在の勢力状況をAIが分析
- **今後の方針**: 天下統一への戦略を議論
- **軍備増強**: 徴兵・城郭強化について
- **隣国への対応**: 攻撃か同盟かを検討
- **調略**: 敵武将の引き抜きや流言

議論の後、具体的な行動案が提示され、実行できます。

### 行動結果

- **大成功**: 予想以上の成果（効果1.5〜2倍）
- **成功**: 通常の成功
- **失敗**: 行動失敗
- **大失敗**: 悪影響が発生

### 調略と寝返り

敵武将を買収（bribe）すると忠誠度が低下し、30以下になると寝返ります。ただし当主は寝返りません。

## 操作方法

| キー | 動作 |
|------|------|
| ↑↓ | 選択移動 |
| Enter | 決定 |
| 1-9 | クイック選択 |
| ESC / BS | 戻る |
| Tab | 議論ログ表示（評定中） |

## 技術スタック

- **UI**: [Ink](https://github.com/vadimdemedes/ink) (React for CLI)
- **AI**: Google Gemini API
- **言語**: TypeScript

## 開発

```bash
# 開発モード（ホットリロード）
npm run dev

# ビルド
npm run build

# プロダクション実行
npm start
```

## ライセンス

ISC
