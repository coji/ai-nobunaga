では、「すぐ実装に入れるレベル」を目標に、三点を順に具体化します。どれも仮説を含みますが、その場合は根拠を明示します。

---

まず、**ターン内にAIが出す命令データの設計**です。

分かっていることとして、Claude Agent SDK は「思考は自由だが、最終出力は機械が検証できる構造化データに落とす」という使い方に非常に向いています。したがって、AIがやるのは「命令文を美文で書くこと」ではなく、「このターンに何をしたいかを、制約付きで申告すること」です。

1ターン1勢力につき、AIは一つの「行動計画オブジェクト」を返します。中身は「内政」「外交」「軍事」「謀略」の最大4カテゴリを持ちますが、すべて埋める必要はありません。たとえば今月は外交だけ、ということも普通にあります。

重要なのは、各行動が必ず「対象」「意図」「実行内容」「リスク許容度」を含む点です。対象は城・勢力・武将などのID、意図は人間向けログに使う短い文章、実行内容は数値化された命令、リスク許容度は失敗時にどこまで悪化を受け入れるかを0〜1で示します。これにより、同じ命令でも性格差が出ます。慎重な大名は低リスク値を返し、信長型は高めを返す、という具合です。

ゲームエンジン側で分かっていることは、「どの命令がルール上可能か」「結果がどうなるか」だけです。成功・失敗の判定や数値の変動はすべてエンジンが行い、AIの命令が現実離れしていれば却下します。AIは「やりたい」と言うだけで、「できたかどうか」は別、という分離が肝です。

---

次に、**武将・派閥・怨恨のデータ設計**です。

ここで大事なのは、「AIに全部を考えさせない」ことです。人間が作るべきなのは、最小限だが解釈の余地があるデータです。

武将は、能力値よりも「固定性格」と「可変感情」を分けます。固定性格は、生涯ほぼ変わらない傾向です。たとえば「権威主義」「実利優先」「義理重視」「猜疑心が強い」などで、数個に絞ります。これは史実ベースでも創作でも構いません。可変感情は、忠誠・恐怖・尊敬・不満のような数値で、イベントによって上下します。

派閥は、武将の集合体であり、「共通の利害」を一文で説明できるものに限定します。たとえば「譜代重臣派＝家の安定と家格維持を最優先」「新参派＝戦功と領地拡大を重視」といった具合です。派閥は主張を持ち、AIが合議するときの“声”になります。

怨恨はイベントログとして扱います。誰が誰に、いつ、何をされたか。その結果として感情がどう動いたか。ここを履歴として保持することで、AIは「なぜこの相手を信用しないのか」を説明できるようになります。分かっていることとして、長期記憶がないAIは外交が薄っぺらくなります。履歴を構造化して渡すのは、その対策です。

---

最後に、**書状UIと文面ルール**です。

ここがこの企画の“顔”になります。分かっていることとして、人は数値ログより文章に感情移入します。一方で、完全自由文はゲームとして扱いづらい。そこで「文章は自由だが、役割が決まっている」という設計を取ります。

一通の書状は、必ず三層構造にします。冒頭は儀礼文で、相手との関係性と格式だけを反映します。中段は本題で、ここに交渉条件や不満、脅しが出ます。末尾は余韻で、感情や含みを匂わせます。AIにはこの三層を明示的に生成させ、特に中段に対応する「実際の契約条件」は別フィールドとしてJSONで同時に出力させます。

文体の揺れは、性格タグから決めます。尊大な人物は主語が大きく、断定的な文が多くなります。猜疑心が強い人物は、条件付き表現が増えます。これらは完全にAI任せにせず、「このタグがある場合は、このトーンを優先する」というガイドラインを与えます。これは仮説ですが、経験上、完全自由生成よりも一貫性が大幅に上がります。

プレイヤーに見せる画面では、文章と同時に「この書状で何が提案されているか」を簡潔に要約したUIを添えます。つまり、読む楽しさと、判断のしやすさを分離します。文章を味わいたい人は読むし、急ぎたい人は要約を見る、という設計です。

---

ここまでが、**AI信長の野望を“作れる形”に落とした設計の第一段階**です。
この内容は、Claude Agent SDKを「人格を持つ意思決定装置」として使う前提で整合しています。

次に進むなら、「信長AIの合議プロンプト全文」「1ターン分の実際の入出力サンプル」「プレイヤーが失敗したときにAIがどう“解釈して学習したように振る舞うか”」まで掘り下げられます。
